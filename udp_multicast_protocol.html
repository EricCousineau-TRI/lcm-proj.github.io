<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>LCM: LCM UDP Multicast Protocol Description</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">LCM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">LCM UDP Multicast Protocol Description </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Conceptually, an LCM message consists of a channel name and a payload. The channel name is a string identifying the semantic grouping of the message (e.g. "ODOMETRY"). The payload is a binary blob of data that corresponds to the contents of the message. Usually, the payload is the binary encoding of a marshalled LCM type.</p>
<p>Each LCM message is transmitted using one or more UDP datagrams to a UDP multicast group and port. The address and port must have been agreed on beforehand &ndash; LCM does not have an automatic discovery mechanism. To publish a message on a channel, an LCM client packages it up as described in the next two sections, and then transmits it directly to the multicast group. If the size of the LCM message is small, then it can be transmitted using a single UDP datagram. Otherwise, the message must be fragmented and transmitted in several parts.</p>
<p>To subscribe to a messaging channel, an LCM client joins the multicast group and inspects each message transmitted to the multicast group, retaining messages of interest and discarding the remainder.</p>
<h1>Small messages</h1>
<p>A small message is defined as one where the LCM small message header, channel name, and the payload can fit into a single UDP datagram. While this can technically be up to 64 kb, in practice the current LCM implementations limit this to 1400 bytes (to stay under the Ethernet MTU).</p>
<p>The header for a small message is 8 bytes long and has the following form: </p>
<pre class="fragment"> 0      7 8     15 16    23 24    31 
+--------+--------+--------+--------+
| short_header_magic                |
+--------+--------+--------+--------+
| sequence_number                   |
+--------+--------+--------+--------+
</pre><p><code>short_header_magic</code> is an unsigned 32-bit integer with value <code>0x4c433032</code></p>
<p><code>sequence_number</code> is a monotonically increasing (subject to integer wraparound) unsigned 32-bit number identifying the message.</p>
<p>Both values are encoded in network byte order (Big-Endian).</p>
<p>The header is followed by the null-terminated UTF-8 encoding of the channel name.</p>
<p>The channel name is followed by the payload.</p>
<h1>Fragmented messages</h1>
<p>Large messages can be split into multiple fragments for transmission. Each fragment is transmitted in a single UDP datagram. The very first fragment consists of a header, followed by the channel name, followed by the first payload bytes. Subsequent fragments consist of a header followed by payload data.</p>
<p>The header for each fragment is 20 bytes long and has the following form: </p>
<pre class="fragment"> 0      7 8     15 16    23 24    31 
+--------+--------+--------+--------+
| fragment_header_magic             |
+--------+--------+--------+--------+
| sequence_number                   |
+--------+--------+--------+--------+
| payload_size                      |
+--------+--------+--------+--------+
| fragment_offset                   |
+--------+--------+--------+--------+
| fragment_number | n_fragments     |
+--------+--------+--------+--------+
</pre><p><code>fragment_header_magic</code> is an unsigned 32-bit integer with value <code>0x4c433033</code></p>
<p><code>sequence_number</code> is a monotonically increasing (subject to integer wraparound) unsigned 32-bit integer identifying the message. The same counter should be used for fragments and for short messages, and all fragments for a single LCM message should have the same sequence number.</p>
<p><code>payload_size</code> is an unsigned 32-bit integer indicating the length of the payload, in bytes. This does not include the length of the channel name.</p>
<p><code>fragment_offset</code> is an unsigned 32-bit integer indicating the payload byte offset of the fragment data within the message payload.</p>
<p><code>fragment_number</code> is an unsigned 16-bit integer with value 0 for the first fragment, 1 for the second, and so on.</p>
<p><code>n_fragments</code> is an unsigned 16-bit integer with value corresponding to the total number of fragments in the message.</p>
<p>All header fields are packed in network byte order (Big-Endian).</p>
<p>The null-terminated UTF-8 encoding of the channel immediately follows the header for the very first fragment of a message. This is followed by the first bytes of the message payload. In subsequent fragments, the payload data immediately follows the fragment header. </p>
</div></div><!-- contents -->
<hr class="footer"/></body>
</html>
